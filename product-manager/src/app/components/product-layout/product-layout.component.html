<!-- NAVBAR -->
<nav class="navbar navbar-expand-lg navbar-dark bg-primary sticky-top">
  <div class="container-fluid">

    <a class="navbar-brand fw-bold me-4" routerLink="/products">
      <i class="bi bi-box-seam me-1"></i> ProdigyHub
    </a>

    <button 
      class="navbar-toggler" 
      type="button" 
      data-bs-toggle="collapse" 
      data-bs-target="#navbarNav" 
      aria-controls="navbarNav" 
      aria-expanded="false" 
      aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div class="collapse navbar-collapse" id="navbarNav">

      <div class="search-bar-container d-none d-lg-block">
       
      </div>

      <ul class="navbar-nav ms-auto align-items-center">

  <li class="nav-item" *ngIf="isAdmin">
    <a class="nav-link active" routerLink="/create-product">Add Product</a>
  </li>

  <li class="nav-item" *ngIf="isAdmin">
    <a class="nav-link active" routerLink="/users">
      <i class="bi bi-people me-1"></i> Users
    </a>
  </li>

  <li class="nav-item" *ngIf="isAdmin">
    <a class="nav-link active" routerLink="/add-user">
      <i class="bi bi-people me-1"></i> Add User
    </a>
  </li>

<li class="nav-item me-2" *ngIf="isUser">
  <a class="nav-link position-relative d-flex align-items-center" routerLink="/wishlist">
    <div class="position-relative d-inline-block">
      <i class="bi bi-heart fs-4 text-white"></i>
      <span *ngIf="wishlistCount > 0"
            class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-warning shadow-sm wishlist-badge">
        {{ wishlistCount }}
      </span>
    </div>
  </a>
</li>


<li class="nav-item me-2" *ngIf="isUser">
  <a class="nav-link position-relative d-flex align-items-center" routerLink="/cart">
    <div class="position-relative d-inline-block">
    <i class="bi bi-cart3 fs-4"></i>
    <span *ngIf="cartCount > 0" 
          class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger shadow-sm cart-badge">
      {{ cartCount }}
    </span>
    </div>
  </a>
</li>

        <li class="nav-item" *ngIf="!user">
          <a class="nav-link" routerLink="/login">Login</a>
        </li>

        <!-- User Dropdown -->
        <li class="nav-item dropdown" *ngIf="user">
          <a class="nav-link dropdown-toggle d-flex align-items-center" href="#" id="userDropdown" role="button"
             data-bs-toggle="dropdown" aria-expanded="false">
            <ng-container *ngIf="avatarUrl; else defaultAvatar">
              <img
                [src]="avatarUrl"
                [alt]="user.username + ' avatar'"
                class="rounded-circle border border-white me-2  profile-avatar"
                style="width: 32px; height: 32px; object-fit: cover;"
              />
            </ng-container>
            <ng-template #defaultAvatar>
              <div
                class="rounded-circle bg-light text-primary d-flex justify-content-center align-items-center border border-white me-2  profile-avatar"
                style="width: 32px; height: 32px; font-weight: 600; font-size: 1rem; user-select: none;">
                {{ user.username.charAt(0) | uppercase }}
              </div>
            </ng-template>
            {{ user.username }}
          </a>
             <ul class="dropdown-menu dropdown-menu-end mt-2" aria-labelledby="userDropdown">
            <li class="px-3 py-2">
              <span class="fw-semibold">{{ user.role }}</span>
            </li>
            
            <li><hr class="dropdown-divider" /></li>
            <li>
              <button class="dropdown-item" (click)="goToEditProfile()">Edit Profile</button>
            </li>
            <li>
              <button class="dropdown-item text-danger" (click)="logout()">Logout</button>
            </li>
          </ul>
        </li>

        <!-- Search Bar (mobile only, inside dropdown) -->
        <li class="nav-item w-100 d-lg-none mt-2">
          <form class="d-flex w-100" role="search">
            <div class="input-group w-100">
              <input
                type="text"
                class="form-control"
                placeholder="Search products..."
                aria-label="Search products"
                [(ngModel)]="searchQuery"
                (input)="onSearch()"
                name="searchMobile"
                ngModel
              />
              <span class="input-group-text bg-white">
                <i class="bi bi-search text-primary"></i>
              </span>
            </div>
          </form>
        </li>

      </ul>
    </div>
  </div>
</nav>

<router-outlet></router-outlet>


